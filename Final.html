<!DOCTYPE html>
<html>
<title>Explore U.S. Mass Shooting - More guns,more violence?</title>
<meta charset="UTF-8">
	<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
	<link href= "animate.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Anton|Hammersmith+One|PT+Sans+Narrow" rel="stylesheet">
	<style type="text/css">
			#mybody{
				background-color: white;
			}

			#h1 {
				font-family: Anton, sans-serif;
				text-align: center;
				font-size:60px;
				color: white;
				position: absolute;
 				top: 50%;
  				left: 50%;
			}

			#h2 {
				font-family: PT Sans Narrow, sans-serif;
				text-align: center;
				font-size:20px;
				color: white;
				position: absolute;
 				top: 70%;
  				left: 70%;
			}

			#h3{
				font-family: PT Sans Narrow, sans-serif;
				text-align: center;
				font-weight: bold;
				font-size:40px;
				color: black;

			}

			#h4 {
				font-family: PT Sans Narrow, sans-serif;
				text-align: center;
				font-weight: bold;
				font-size:30px;
				color: black;
			}

			#byline{
				font-family: PT Sans Narrow, sans-serif;
				text-align: right;
				font-size:15px;
				color: white;
				position: absolute;
 				top: 75%;
  				left: 75%;
			}

			#source{
				font-family: Optima, sans-serif;
				text-align: center;
				font-size: 15px;
				font-style: italic;
			}

			#p {
				font-family: Optima, sans-serif;
				float: left;
  				margin-left: 200px;
				margin-right: 200px;
				text-align: left;
				font-size: 18px;
			}
			#n1{
				font-family: Optima, sans-serif;
				color: darkred;
				font-weight: bold;
			}

			#coverpage{
				width:100%;
			}

			#container{
				text-align: center;
				animation-duration: 2s;
			}

			#tooltip{
				position: absolute;           
			  	text-align: center;           
			  	width: 60px;                  
			 	height: 28px;                 
			  	padding: 2px;             
			  	font: 12px sans-serif;        
			  	background: lightsteelblue;   
			  	border: 0px;                
			  	pointer-events: none;         
			}

			.arc text {
			  font-family: Optima, sans-serif;
			  font-size: 20px;
			  text-anchor: middle;
			}

			#transition {
				font-family: Anton, sans-serif;
				text-align: center;
				font-size:50px;
				color: white;
				position: absolute;
				margin-left: 300px;
				margin-right: 300px;
				margin-top: 350px;
			}

			#transition1 {
				font-family: Optima, sans-serif;
				text-align: center;
				font-size:30px;
				color: white;
				position: absolute;
				margin-left: 300px;
				margin-right: 300px;
				margin-top: 600px;
			}

			#transitiontext{
				text-align: center;
				animation-duration: 3s;
			}

			#subhead {
				font-family: PT Sans Narrow, sans-serif;
				text-align: left;
				font-size:30px;
				color: black;
				margin-left: 300px;
				margin-right: 300px;
			}


		</style>

<body id="mybody">
	<div id="container" class="item animated fadeIn";>
		<img src="finalintro.png" id="coverpage">
	<h1 id="h1">More Guns, More Violence?</h1>
	<h2 id="h2">Explore U.S. major mass shooting since 1982</h2>
	<p id="byline">By Ruobing Su</p>
	</div>
</body>

	<head>
		<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
		<script src="https://unpkg.com/topojson@3"></script>
	</head>

	<body>
		<div>
		<h2 id="h3">U.S. Major Mass Shooting since 1982</h2>
		<p id="p">The deadly school shooting in Parkland in Feburary, has ignited national outrage and calls for action on gun reform. Since 1982, there have been <span id="n1">at least 98 </span> public mass shootings across the country, with the killings unfolding in 34 states from Massachusetts to Hawaii; <span id="n1">fifty-nine</span> of these mass shootings have occurred since 2006. </p>
		<p id="p">Although, the definition of mass shooting varies place to place, according to FBI, <span id="n1">a wide range of gun crimes in which four or more people have been either wounded or killed can </span> be called as mass shooting. The following data on U.S. major mass shooting since 1982 is collected by Mother Jones, a progressive American magazine. The data set has excluded shootings stemming from more conventional crimes such as armed robbery or gang violence. </p>
		<br>
		<p id="source">Data source: Mother Jones</p>
		</div>
		<div align="center">
			<svg id="map" width="1000" height="800" align="center">
				<rect width=1000 height=800 fill="" opacity="0" align="center"></rect>
			</svg>
		</div>

	</body>
	<div>

	<script type="text/javascript">
		d3.queue()
			.defer(d3.json, "usa.json")
			.defer(d3.csv, "Massshooting.csv")
			.defer(d3.csv, "gunownership.csv")
			.awaitAll(function(error,dataArray){
				var data = dataArray[0];
				var shooting = dataArray[1];
				var ownership = dataArray [2];
				console.log(dataArray);
//printing the map 
			var geoJSON = topojson.feature(data,data.objects.states);
			
			var proj = d3.geoAlbersUsa()
				.fitSize([1000,800],geoJSON); 

			var path = d3.geoPath()
			.projection(proj); 

			var states = d3.select("#map").selectAll("path")
				.data(geoJSON.features);

			var div = d3.select("body")
				.append("div")
				.attr("class","tooltip")
				.style("opacity", 0)

			var lowColor = "#f9f9f9"
			var highColor = "#922B21"

			//passing the path to svg and setting up the "d" value to draw a path 
			states.enter().append("path") 
					.attr("fill","gainsboro")
					.attr("stroke","white")
					.attr("stroke-width",1.5)
					.attr("d",function(feature){
						return path(feature);
					});


			//load my data into the file, make sure you create a new data array and variable accordingly
			
			var dots = d3.select("#map").selectAll("circle")
			.data(shooting);


			dots.enter().append("circle")
				.attr("transform",function(point){
					return "translate(" + proj([point.longitude,point.latitude]) + ")"
				})
				.attr("fill","black") //if you want to use data in csv, make sure have point.before the column name 
				.attr("stroke-width",.5)
				.attr("opacity",.85)
				.attr("r", function(point){
					return point.Fatalities/1.2;
				})
					//mouseover event
				.on("mouseover", function(d) {
			    d3.select(this)
			      .classed("mouseover", true)
			      .attr("r", function(d) {return d["Totalvictims"]/3 + "px"})
			      .attr("class", "hoveredpoints")
			      .attr("fill","Darkred")
			      .attr("opacity",.7);
				  })

			    .on("mouseleave", function(d){
				d3.select("#tooltip")
				.style("display","none");
				})

				 .on("mouseenter", function(d){
			    d3.select("#tooltip")
			    	.style("display","block")
			    	.text(d.Case);
			    })
			    		
			 	.on("mouseout", function(d) {
			    d3.select(this)
			      .attr("r", function(point){
					return point.Fatalities / 1.5;
				})
			      .attr("fill", "black")
			      .attr("class", "points")
			      .attr("opacity",0.75)
			      .classed("mouseover", false);
			  });

			});


		
	</script>
	</div>
	<div id="transitiontext" class="item animated fadeIn">
		<h1 id="transition">The U.S. makes up less than 5% of the world population, but holds 31% of global mass shooters.</h1>
		<h2 id="transition1">What are some causes and effects behind the horrifying number?</h2>
		<img src="transition1.png" id="coverpage">
		
	</div>

	<div>
		<h4 id="subhead">The numbers are staggering: U.S. has the most public mass shooters in the world, study shows.</h4>
		<p id="p">Among 97 cases that have been recorded by Mother Jones, all the mass shooting happened in public. Among which, working place is where a great amount of mass shooting happened; secondly schools and millitary; streets, restaurants, airports, public parties, clubs and other places are included as "others." 
		<br>Adam Lankford of University of Alabama studied mass shootings in 171 countries from the years 1966-2012 and found that the United States has the most public mass shooters and more than 240 million more guns than the second highest country, India.</p>

	<script type="text/javascript">
		//pie chart of venue 	
		var data = [16, 28, 5, 43];

		var width = 960,
		    height = 500,
		    radius = Math.min(width, height) / 2;

		var color = d3.scaleOrdinal()
		    .range(["#F2D7D5", "#D98880", "#C0392B", "#641E16"]);

		var arc = d3.arc()
		    .outerRadius(radius - 10)
		    .innerRadius(0);

		var labelArc = d3.arc()
		    .outerRadius(radius - 40)
		    .innerRadius(radius - 40);

		var pie = d3.pie()
		    .sort(null)
		    .value(function(d) { return d; });

		var svg = d3.select("body").append("svg")
		    .attr("width", width)
		    .attr("height", height)
		  	.append("g")
		    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

		  var g = svg.selectAll(".arc")
		      .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  g.append("path")
		      .attr("d", arc)
		      .style("fill", function(d) { return color(d.data); });

		  g.append("text")
		      .attr("transform", function(d) { return "translate(" + labelArc.centroid(d) + ")"; })
		      .attr("dy", ".35em")
		      .text(function(d) { return d.data; });
			</script>
		</div>



	


</html>
